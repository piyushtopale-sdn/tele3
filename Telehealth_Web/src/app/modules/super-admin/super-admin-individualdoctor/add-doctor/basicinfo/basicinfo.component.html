<div class="step_counter_inner edit_profile_block login_time">
  <div class="create_profile">
    <h1 *ngIf="!pageForAdd">{{ "edit_doctor" | translate }}</h1>
    <div class="create_profile_inner">
      <div class="user_image_upload">
        <input id="file-input" class="upload_input" type="file" accept="image/*"
          (change)="onFileSelected($event, 'profile')" />
        <div class="user_upload_block">
          <span class="user_upload_wrapper">
            <span class="user_upload_icon">
              <img class="img-fluid" src="{{
                  profileImage ? profileImage : 'assets/img/create_profile.png'
                }}" />
              <span class="quick_view" *ngIf="profileImage ? true : false">
                <mat-icon class="closeicon" (click)="removeSelectpic('profileImage')">close</mat-icon>
              </span>
            </span>
          </span>
          <span class="edit_upload_wrapper">
            <span class="edit_upload_icon"><img src="../../../assets/img/edit_profile.svg" /></span>
          </span>
        </div>
      </div>
      <div class="image-upload d-none">
        <label for="file-input">
          <img class="img-fluid mb-4" src="{{
              profileImage ? profileImage : 'assets/img/create_profile.png'
            }}" />

          <i class="fa fa-camera" *ngIf="!profileImage"></i>
        </label>
        <span class="quick_view" *ngIf="profileImage ? true : false">
          <mat-icon class="closeicon" (click)="removeSelectpic('profileImage')">close</mat-icon>
        </span>
        <input id="file-input" type="file" accept="image/*" (change)="onFileSelected($event, 'profile')" />
      </div>
      <form [formGroup]="basicInfo">
        <div class="form">
          <div class="row">
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "first_name" | translate }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="first_name" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['first_name'].errors?.['required']">
                  {{ "enter_first_name" | translate }}*
                </span>
                <!-- Invalid characters -->
                <span class="text-danger" *ngIf="f['first_name'].errors?.['onlyCharacters'] as error">
                  {{ error.message }}
                </span>

                <!-- Length exceeded -->
                <span class="text-danger" *ngIf="f['first_name'].errors?.['maxLength'] as error">
                  {{ error.message }} ({{ error.actualLength }} / {{ error.requiredLength }})
                </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "first_name_arabic" | translate }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="first_name_arabic" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['first_name_arabic'].errors?.['required']">
                  {{ "enter_first_name" | translate }}*
                </span>
               <!-- Invalid characters -->
               <span class="text-danger" *ngIf="f['first_name_arabic'].errors?.['onlyCharacters'] as error">
                {{ error.message }}
              </span>

              <!-- Length exceeded -->
              <span class="text-danger" *ngIf="f['first_name_arabic'].errors?.['maxLength'] as error">
                {{ error.message }} ({{ error.actualLength }} / {{ error.requiredLength }})
              </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "middle_name" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="middle_name" />
                </mat-form-field>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "middle_name_arabic" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="middle_name_arabic" />
                </mat-form-field>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "last_name" | translate }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="last_name" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['last_name'].errors?.['required']">
                  {{ "enter_last_name" | translate }}*
                </span>
                <!-- Invalid characters -->
               <span class="text-danger" *ngIf="f['last_name'].errors?.['onlyCharacters'] as error">
                {{ error.message }}
              </span>

              <!-- Length exceeded -->
              <span class="text-danger" *ngIf="f['last_name'].errors?.['maxLength'] as error">
                {{ error.message }} ({{ error.actualLength }} / {{ error.requiredLength }})
              </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "last_name_arabic" | translate }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="last_name_arabic" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['last_name_arabic'].errors?.['required']">
                  {{ "enter_last_name" | translate }}*
                </span>
                 <!-- Invalid characters -->
               <span class="text-danger" *ngIf="f['last_name_arabic'].errors?.['onlyCharacters'] as error">
                {{ error.message }}
              </span>

              <!-- Length exceeded -->
              <span class="text-danger" *ngIf="f['last_name_arabic'].errors?.['maxLength'] as error">
                {{ error.message }} ({{ error.actualLength }} / {{ error.requiredLength }})
              </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-8">
              <div class="form_field_wrapper">
                <label>{{ "address" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput placeholder="{{ 'enter_address' | translate }}" formControlName="address"
                    #address />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['address'].errors?.['required']">{{ "enter_address" |
                  translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "neighborhood" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="neighborhood" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['neighborhood'].errors?.['required']">{{
                  "enter_neighbourhood" | translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper modal-body">
                <label>{{ "country" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="nationality" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['nationality'].errors?.['required']">{{
                  "select_country" | translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "region" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="region" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['region'].errors?.['required']">{{ "select_region" |
                  translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "province" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="province" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['province'].errors?.['required']">{{ "select_province"
                  | translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "Department" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="department" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['department'].errors?.['required']">{{
                  "select_department" | translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "city" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="city" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['city'].errors?.['required']">{{ "select_city" |
                  translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "village" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="text" matInput formControlName="village" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['village'].errors?.['required']">{{ "select_village" |
                  translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "pincode" | translate }}</label>
                <mat-form-field appearance="fill">
                  <input type="number" matInput formControlName="pincode" (input)="pinforceMaxLength($event)"
                  maxlength="6"/>
                </mat-form-field>
                <span class="text-danger" *ngIf="f['pincode'].touched && f['pincode'].errors?.['pattern']">{{ "pincode_must_be_at_least_5_digits" |
                  translate }}</span>                  
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "phone_number" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="mobile" matInput formControlName="mobile" #mobile (focus)="onFocus()"
                    (input)="onMobileInput($event)" ng2TelInput maxlength="11" placeholder="XX-XXX-XXXX" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['mobile'].errors?.['required']">{{
                  "enter_phone_number" | translate }}*</span>
                <span class="text-danger" *ngIf="f['mobile'].errors?.['pattern'] && f['mobile'].invalid">
                  {{ "enter_10_digit_number" | translate }}
                </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "date_of_birth" | translate }}<span class="danger">*</span></label>
                <mat-form-field class="example-full-width" appearance="fill">
                  <input matInput [matDatepicker]="picker" formControlName="dob" [max]="maxDate" (focus)="picker.open()" 
                  readonly (input)="formatDate($event)" placeholder="DD/MM/YYYY" />
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['dob'].errors?.['required']">
                  {{ "enter_date_of_birth" | translate }}*
                </span>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "gender" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <!-- <mat-label>Sub-admin</mat-label> -->
                  <mat-select disableRipple formControlName="gender">
                    <mat-option value="male">{{
                      "male" | translate
                      }}</mat-option>
                    <mat-option value="female">{{
                      "female" | translate
                      }}</mat-option>
                  </mat-select>
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['gender'].errors?.['required']">{{ "select_gender" |
                  translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper speciality-select-block">
                <label>{{ "language" | translate }}</label>
                <select2 class="test" [overlay]="overlay" multiple="multiple" [limitSelection]="0"
                  [minCountForSearch]="0" [data]="spokenLanguages" [(ngModel)]="selectedLanguages"
                  formControlName="language" (update)="onSelectionChange($event)">
                </select2>
                <span class="text-danger" *ngIf="isSubmitted && f['language'].errors?.['required']">{{ "select_language"
                  | translate }}*</span>
              </div>
            </div>

            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "doctor_fees" | translate }}</label>
                <mat-form-field appearance="fill">
                  <span matPrefix>SAR&nbsp;</span>
                  <input type="text" matInput formControlName="doctorfees" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['doctorfees'].errors?.['required']">{{ "required" |
                  translate }}*</span>
              </div>
            </div>
          </div>

          <div class="row">
            <!-- Speciality Field -->
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper speciality-select-block">
                <label>{{ "speciality" | translate }}<span class="danger">*</span></label>
                <select2 class="test" [overlay]="true" multiple="multiple" [limitSelection]="0" [minCountForSearch]="0"
                  [data]="specialityListt" [(ngModel)]="selectedSpeciality" formControlName="speciality"
                  (update)="onSpecialityChange($event)">
                </select2>
                <span class="text-danger" *ngIf="isSubmitted && f['speciality'].errors?.['required']">{{
                  "select_speciality" | translate }}*</span>
              </div>
            </div>

            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "designation" | translate
                  }}<span class="danger">*</span></label>
                <select2 [overlay]="overlay" [limitSelection]="0" [minCountForSearch]="0" [data]="deginationList"
                  formControlName="designation">
                </select2>
                <span class="text-danger" *ngIf="isSubmitted && f['designation'].errors?.['required']">{{
                  "select_designation" | translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "years_of_experience" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="number" matInput formControlName="experience" />
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['experience'].errors?.['required']">{{
                  "enter_years_of_experience" | translate }}*</span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4">
              <div class="form_field_wrapper speciality-select-block">
                <label>{{ "category" | translate }}</label>
                <select2 class="test" [overlay]="true" multiple="multiple" [limitSelection]="0" [minCountForSearch]="0"
                  [data]="categoryListt" [(ngModel)]="selectedCategories" formControlName="categoryIds"
                  (update)="onCategoryChange($event)">
                </select2>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-6 col-md-4 mt-3 mb-3">
              <div class="form_field_wrapper">
                <label>{{ "email" | translate }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <input type="email" matInput formControlName="email" />
                </mat-form-field>

                <span class="text-danger" *ngIf="isSubmitted && f['email'].errors?.['required']">{{ "enter_email" |
                  translate }}*</span>

                <span class="text-danger" *ngIf="f['email'].errors?.['pattern'] && f['email'].invalid">
                  {{ "please_enter_valid_email" | translate }}
                </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mt-3 mb-3" *ngIf="pageForAdd">
              <div class="form_field_wrapper">
                <label>{{ "password" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill" class="password-input-block">
                  <input type="password" matInput formControlName="password" [type]="hide1 ? 'password' : 'text'" />
                  <a class="password-view" (click)="hide1 = !hide1">
                    <mat-icon>{{
                      hide1 ? "visibility_off" : "visibility"
                      }}</mat-icon>
                  </a>
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['password'].errors?.['required']">
                  {{ "enter_password" | translate }}
                </span>
                <span class="text-danger" *ngIf=" f['password'].errors?.['minlength']">
                  {{ "must_be_atleast_8_char" | translate }}
                </span>
                <span class="text-danger" *ngIf="f['password'].errors?.['hasNumber']">
                  {{ "must_contain_atleast_1_number" | translate }}
                </span>
                <span class="text-danger" *ngIf="f['password'].errors?.['hasCapitalCase']">
                  {{ "must_contain_atleast_1_capcase" | translate }}
                </span>
                <span class="text-danger" *ngIf="f['password'].errors?.['hasSmallCase']">
                  {{ "must_contain_atleast_1_smallcase" | translate }}
                </span>
                <span class="text-danger" *ngIf="f['password'].errors?.['hasSpecialCharacters']">
                  {{ "must_contain_atleast_1_specialchar" | translate }}
                </span>
              </div>
            </div>
            <div class="col-sm-6 col-md-4 mt-3 mb-3" *ngIf="pageForAdd">
              <div class="form_field_wrapper">
                <label>{{ "confirm_password" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill" class="password-input-block">
                  <input type="password" matInput formControlName="confirm_password"
                    [type]="hide2 ? 'password' : 'text'" />
                  <a class="password-view" (click)="hide2 = !hide2">
                    <mat-icon>{{
                      hide2 ? "visibility_off" : "visibility"
                      }}</mat-icon>
                  </a>
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['confirm_password'].errors?.['required']">{{
                  "confirm_password" | translate }}*</span>

                <span class="text-danger" *ngIf="isSubmitted && f['confirm_password'].errors?.['matching']">
                  {{ "confim_password_does_not_match" | translate }}
                </span>
              </div>
            </div>
          </div>
          <div class="about_doctor divider">
            <h2>{{ "about_doctor" | translate }}</h2>
            <div class="row">
              <div class="col-sm-12 col-md-12">
                <div class="form_field_wrapper">
                    <div class="editor_inner">
                      <ngx-editor-menu [editor]="abouteditor" [toolbar]="toolbar"></ngx-editor-menu>
                      <ngx-editor 
                        [editor]="abouteditor" 
                        formControlName="aboutDoctor"
                        [placeholder]="'about_doctor' | translate"
                      ></ngx-editor>
                    </div>      
                  <span class="text-danger" *ngIf="isSubmitted && f['aboutDoctor'].errors?.['required']">{{ "required" |
                    translate }}*</span>
                </div>
              </div>
            </div>
          </div>
          <div class="about_doctor divider">
            <h2>{{ "about_doctor_arabic" | translate }}</h2>
            <div class="row">
              <div class="col-sm-12 col-md-12">
                <div class="form_field_wrapper">
                  <div class="editor_inner">
                    <ngx-editor-menu [editor]="abouteditor_arabic" [toolbar]="toolbar"></ngx-editor-menu>
                    <ngx-editor 
                      [editor]="abouteditor_arabic" 
                      formControlName="aboutDoctorArabic"
                      [placeholder]="'about_doctor' | translate"
                    ></ngx-editor>
                  </div> 
                  <span class="text-danger" *ngIf="isSubmitted && f['aboutDoctorArabic'].errors?.['required']">
                    {{ "required" | translate }}*
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div class="license divider" formGroupName="license_details">
            <h2>{{ "license" | translate }}</h2>
            <div class="row">
              <div class="col-sm-12 col-md-4 mb-3 col-lg-4 col-xl-4">
                <div class="form_field_wrapper">
                  <label>{{ "license_number" | translate
                    }}<span class="danger">*</span></label>
                  <mat-form-field appearance="fill">
                    <input  matInput formControlName="license_number" (input)="onLicenseNumberInput($event)" maxlength="20">
                  </mat-form-field>
                  <span class="text-danger"
                    *ngIf="isSubmitted && f['license_details'].get('license_number').errors?.['required']">{{
                    "enter_license_number" | translate }}*</span>
                    
                  <span 
                  class="text-danger"
                  *ngIf="
                    f['license_details'].get('license_number').touched &&
                    f['license_details'].get('license_number').errors?.['pattern']
                  "
                >
                  {{ "license_number_not_less_than_6_digits" | translate }}
                </span>
                </div>
              </div>
              <div class="col-sm-12 col-md-8 col-lg-8 col-xl-5">
                <div class="form_field_wrapper">
                  <label>{{ "expiry_date" | translate}}
                    <span class="danger">*</span>
                  </label>
                  <div class="license_date">
                    <mat-form-field class="example-full-width" appearance="fill">
                      <input matInput placeholder="{{ 'expiry_date' | translate }}" [matDatepicker]="picker3"
                        formControlName="license_expiry_date" (click)="picker3.open()" [min]="minDate" readonly/>
                      <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                      <mat-datepicker #picker3></mat-datepicker>
                    </mat-form-field>             
                  </div>
                  <span class="text-danger"
                    *ngIf="isSubmitted && f['license_details'].get('license_expiry_date').errors?.['required']">{{
                    "enter_license_expiry_date" | translate }}*</span>
                    <span
                      class="text-danger"
                      *ngIf="
                        isSubmitted &&
                        basicInfo.get('license_details.license_expiry_date')?.errors?.['notFutureDate']
                      "
                    >
                    {{"License_expiry_must_future_date" | translate}}
                    </span>
                </div>
              </div>
              <div class="col-12">
                <div class="form_field_wrapper">
                  <div class="row form-field-insurance">
                    <div class="upload_item col-sm-6 col-md-6 mb-4">
                      <div class="upload_output" *ngIf="license_picture_">
                        <div class="upload_input_content">
                          <img src="{{ license_picture_ }}" style="width: 200px" />
                          <button class="btn btn-transparent closing-icon"
                            (click)="removeSelectpic('license_picture_')">
                            <mat-icon class="close icon">close</mat-icon>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="upload_item col-sm-6 col-md-6">
                      <div class="upload_input">
                        <div class="upload_input_content">
                          <img src="assets/img/add_box.svg">
                          <label class="upload_text" (click)="licenceUpload.click()">{{ "upload_picture" | translate
                            }}</label>
                        </div>
                        <input type="file" accept="image/*" hidden (change)="onFileSelected($event, 'license')"
                          #licenceUpload />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-12 col-md-12 col-lg-12 col-xl-3 upload_item d-none">
                <div class="form_field_wrapper">
                  <span class="quick_view" *ngIf="license_picture_">
                    <mat-icon class="closeicon" (click)="removeSelectpic('license_picture_')">close</mat-icon>
                  </span>
                  <img id="preview-image" src="{{ license_picture_ }}" style="width: 150px" *ngIf="licenseFile" />
                  <div class="upload_input">
                    <div class="upload_input_content">
                      <label>{{ "upload_cart_picture" | translate }}</label>
                    </div>
                    <input class="ng-hide user_upload_input" id="input-file-id" type="file" accept="image/*"
                      (change)="onFileSelected($event, 'license')" />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="primary_btn btn_wrap">
    <button type="button" class="btn btn-secondary" [routerLink]="['/super-admin/doctor']">
      {{ "cancel" | translate }}
    </button>
    <button type="button" class="btn btn-primary" (click)="handleSaveBasicInfo()">
      {{ "save_and_next" | translate }}
    </button>
  </div>
</div>